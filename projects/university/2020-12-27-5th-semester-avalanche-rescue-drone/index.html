<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Avalanche Rescue Drone | Magnus Borresen</title> <meta name="author" content="Magnus Borresen"/> <meta name="description" content="Personal website for Magnus Borresen "/> <meta name="keywords" content="academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon.ico"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://magnusborresen.com/projects/university/2020-12-27-5th-semester-avalanche-rescue-drone/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://magnusborresen.com/"><span class="font-weight-bold">Magnus</span> Borresen</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Avalanche Rescue Drone</h1> <p class="post-description"></p> </header> <article> <p>For our 5th semester project, my group and I chose to work on a project that I proposed. I had seen some attemps at making drones that could be used for avalanche rescue operations, but none of them seemed to work very well. So we decided that we would investigate and see if we could make such a drone ourselves. This was definitely one of the most extensive projects during my university studies.</p> <p>The 5th semester of the EE bachelors at AAU is focused around Control Systems, Signal Processing and Wireless Systems. So we knew we had to incorporate some of that into the project. Given that we would be working with drones, we thought the Control Systems part would be pretty easy to cover. Signal Processing would be covered by the fact that we had to analyze an analog signal coming from the antenna (or actually rather coil) on the drone. Given that signals were transmitted wirelessly, the Wireless Systems were also easily covered.</p> <p>We started off by borrowing a DJI Matrice 100 from the Wireless Systems department. The drone had a UART interface and an SDK from DJI. We could then connect a Rapsberry Pi through UART and mount it on top of the drone. The plan was then to have the math run on the Pi and let it send commands to the drone accordingly. We had inteded to power the Raspberry Pi directly from the Matrice’s battery pack, but the 22 V nominal battery was to much to handle for a Linear Regulator, so we ended up mounting a two 18650’s in series to power the Pi.</p> <p>Avalanche transceivers generally work on 457 kHz and are made up of 2 – 3 coils wrapped around a ferromagnetic material. The coils are oriented at 90 degree angles of each other, such that the magnetic field they produce does not cancel out. Orienting them this way makes in possible to find the transmitter from a multiple of angles. Due to the fact that it is the magnetic fields and not the EM field that is being utilized for the search.</p> <p>We chose to use a rather large signal chain. So from the coils, the signal was routed to an LNA that we designed with discrete components, then an analog bandpass filter, Anti-aliasing filter and lastly being DC-offset before the ADC would sample the signal. We chose to use an ADS7883 for the sampling since we did not want to add comlexity by adding a down mixer. The ADS7883 had an adaquete sampling rate with 12 bits of resolution. Meaning we could detect the signal from further away.</p> <p>To design the coils, we used the equivalent circuit shown below.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/seriel_resonans-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/seriel_resonans-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/seriel_resonans-1400.webp"></source> <img src="/assets/img/projects/seriel_resonans.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>The coils were made by wrapping some coated wire around a ferromagnetic rod which increased the inductance of the coil. We could the tune it to the resonance frequency we wanted by varying the capacitor connected across the coil terminals. Unfortunately, the pictures I had of the coils were lost. We ended up with a Q value of the coil of 45 and we were able to tune the antenna to the required frequency.</p> <p>From theory of how strong the field emitted by Avalanche transceiver should be, we could calculate a signal strength over distance and plot it. We could then measure the signal strength of our designed antenna and see if they matched up. The result can be seen in the figure below.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/Afstandsplot-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/Afstandsplot-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/Afstandsplot-1400.webp"></source> <img src="/assets/img/projects/Afstandsplot.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>x-axis shows the distance between the transmitter and receiver and the y-axis shows the expected voltage across the coil. The blue solid line shows the signal strength to distance with the lowest allowed signal strength of the transmitter. The red solid line shows the highest allowed signal strength. The dots are our measurements. The reason for the difference in colors for our measurements is because we had to use amplification after 3-4 meters. Otherwise the signal would be too weak to visually identify on an oscilloscope.</p> <p>The LNA that followed the coils were designed with a differential amplifier BJT circuit, biased by a Wilson Current Mirror. Further voltage amplification was achieved with an output compound coupling. Circuit is shown below.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/LNA_design_oversigt-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/LNA_design_oversigt-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/LNA_design_oversigt-1400.webp"></source> <img src="/assets/img/projects/LNA_design_oversigt.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>It gave a descent frequency response. But I am not sure that we actually made it that low noise… We should probably have been using MOSFETS instead, but hey… We had fun and learned.</p> <p>The bandpass filter was implemented as a Sallen-Key topology, which implements an active second order filter. Calculations and implementation was made according to the very nice <a href="https://www.analog.com/media/en/training-seminars/design-handbooks/Basic-Linear-Design/Chapter8.pdf?%20fbclid=IwAR0Dex1RccXly5lKh_jKvWUySV0ouwJgtTJv3xNLcxjBjuMLkIUCUeHTny4" target="_blank" rel="noopener noreferrer">handb</a><a href="https://www.analog.com/media/en/training-seminars/design-handbooks/Basic-Linear-Design/Chapter8.pdf?%20fbclid=IwAR0Dex1RccXly5lKh_jKvWUySV0ouwJgtTJv3xNLcxjBjuMLkIUCUeHTny4" target="_blank" rel="noopener noreferrer">ook from Analog Devices</a>.</p> <p>I won’t get more into the anti-aliasing filter as this is pretty standard to use when sampling a signal that you want to further analyze and work on discretely. We had to implement a DC-offset as well because the ADC would not go to negative voltages.</p> <p>After sampling we had a digital filter which I won’t get into either because it was unecessary to have and very badly designed and implemented. But we wanted to try it out since it was a part of our curriculum.</p> <p>So at this point we pretty much just had to do some math work on the sampled signals and then steer the drone in the direction the math told us. Then came the second COVID lockdown and we were unable to sit in the same room and work on the drone. So our solution was to simulate everything. Luckily, DJI also provided a simulator with the they provided. Only problem is that the drone has to be connected to the computer in order for the simulation to work. Which meant that only one person could test the drone software at a time, which does become pretty tedious for the person testing.</p> <p>To do a control system for the drone, we tried measuring the drone’s step response. This we thought would be a good idea since we might need the drone to turn fast when searching. So we went out in a low wind day with a preprogrammed Rasperry Pi. The Pi was to change the yaw of the drone 5 degrees as fast as possible. Then we could record the yaw angle during the procedure. Using that data, we were able to make a 2nd order approximation of the system. We tried using the MATLAB System Identifier tool to confirm the approximation, but the tool showed that a fifth order system was needed to most accurately model the response. The measured response and approximations is shown below.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/step_plot_med_5_orden-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/step_plot_med_5_orden-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/step_plot_med_5_orden-1400.webp"></source> <img src="/assets/img/projects/step_plot_med_5_orden.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Measured step response, 2nd order approximation and 5th order approximation. However we decided to work with the 2nd order approximation since the MSE was still quite low. Though we actually ended up scrapping it, since our conclusion with multiple simulations, was that DJI has (surprise surprise) made a pretty good control system, and our system did not gain anything from us messing with it. A flow diagram of the entire system can be seen below.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/drone_flow-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/drone_flow-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/drone_flow-1400.webp"></source> <img src="/assets/img/projects/drone_flow.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>So search areas were split into rough search and fine search. Rough search is where the drone is actually helpful. The idea is that the drone will find the signal from 50-100 m away and then land within 1-3 meters of the buried person.</p> <p>Simulations showed that the algorithm and system on the Pi would work. However we never got to test it out in the world. Below is a plot of the simulation results. The drone starts at position [0,0] and the transmitter is located at [40,40]. Various amounts of noise was introduced to the system and signal to stress test.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/Simulation_noise_plot-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/Simulation_noise_plot-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/Simulation_noise_plot-1400.webp"></source> <img src="/assets/img/projects/Simulation_noise_plot.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Magnus Borresen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QG1FB01NT0"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QG1FB01NT0");</script> </body> </html>